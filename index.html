<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üíà Barber Studio Zuriel Miranda</title>

  <!-- Fuente elegante -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

  <!-- Librer√≠a de animaciones AOS -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Poppins', sans-serif;
      background-color: #0c0c0c;
      color: #f5f5f5;
      scroll-behavior: smooth;
      transition: background 0.3s, color 0.3s;
    }

    body.light {
      background-color: #f9f9f9;
      color: #111;
    }

    header, section { width: 100%; }

    a { color: inherit; text-decoration: none; }

    nav {
      background: rgba(0,0,0,0.85);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 30px;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 100;
      border-bottom: 1px solid #222;
      flex-wrap: wrap;
    }

    nav h2 {
      color: #d4af37;
      font-weight: 700;
      font-size: 1rem;
    }

    .info-horario {
      width: 100%;
      text-align: center;
      color: #d4af37;
      font-size: 0.75rem;
      margin-top: 3px;
      line-height: 1.1rem;
    }

    nav ul {
      display: flex;
      list-style: none;
      gap: 18px;
    }

    nav ul li a {
      font-weight: 500;
      font-size: 0.85rem;
      transition: color 0.3s;
    }

    nav ul li a:hover { color: #d4af37; }

    #modo, #logout {
      background: #d4af37;
      border: none;
      border-radius: 5px;
      color: #111;
      padding: 4px 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 0.8rem;
      transition: 0.3s;
      margin-left: 8px;
    }

    #modo:hover, #logout:hover { background: #f1c93b; }

    .hero {
      position: relative;
      height: 90vh;
      background: url('https://images.unsplash.com/photo-1585747860715-4f98f0b8d3a5?auto=format&fit=crop&w=1500&q=80') no-repeat center center/cover;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      margin-top: 80px;
    }

    .overlay {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
    }

    .hero-content { position: relative; z-index: 2; color: #fff; }

    .hero h1 { font-size: 3rem; color: #d4af37; margin-bottom: 15px; }
    .hero p { font-size: 1.2rem; color: #ccc; margin-bottom: 25px; }

    .btn-cta {
      background: #d4af37;
      color: #111;
      padding: 12px 25px;
      border-radius: 5px;
      font-weight: bold;
      transition: 0.3s;
    }

    .btn-cta:hover { background: #f1c93b; transform: scale(1.05); }

    .servicios { padding: 80px 10%; text-align: center; }
    .servicios h2 { color: #d4af37; font-size: 2rem; margin-bottom: 40px; }

    .grid-servicios {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
    }

    .servicio {
      background: #1b1b1b;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 0 15px rgba(212,175,55,0.15);
      transition: transform 0.3s;
      padding: 20px;
      text-align: left;
    }

    .servicio:hover { transform: translateY(-5px); }

    .formulario {
      background: rgba(30,30,30,0.95);
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(212,175,55,0.2);
      max-width: 600px;
      margin: 60px auto;
      text-align: left;
    }

    .formulario h2 { text-align: center; color: #d4af37; margin-bottom: 25px; }

    label { display: block; margin-top: 15px; font-weight: 500; }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 8px;
      border: 1px solid #444;
      border-radius: 5px;
      background: #1b1b1b;
      color: #fff;
      transition: border 0.3s;
    }
    input:focus, select:focus { border: 1px solid #d4af37; outline: none; }

    .btn-enviar {
      width: 100%;
      background: #d4af37;
      color: #111;
      font-weight: bold;
      border: none;
      padding: 12px;
      border-radius: 5px;
      margin-top: 25px;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
    }
    .btn-enviar:hover { background: #f1c93b; transform: translateY(-2px); }

    #recordatorio {
      text-align: center;
      background: #1b1b1b;
      color: #f1c93b;
      padding: 15px;
      border-radius: 8px;
      margin: 30px auto;
      width: 80%;
      display: none;
    }

    .citas { padding: 40px 10%; }
    .citas ul { list-style: none; margin-top: 15px; color: #ccc; }
    .citas li { margin-bottom: 10px; }

    footer {
      background: #000;
      color: #aaa;
      text-align: center;
      padding: 25px 10px;
      font-size: 0.9rem;
      border-top: 1px solid #222;
    }

    footer p:first-child { color: #d4af37; }

    @media (max-width: 768px) { nav ul { display: none; } }

    /* --- Estilos para las im√°genes cuadradas --- */
.servicios-imagenes {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 30px;
  flex-wrap: wrap;
}

.servicios-imagenes img {
  width: 250px;            /* tama√±o cuadrado */
  height: 250px;           /* tama√±o cuadrado */
  object-fit: cover;       /* recorta para mantener proporci√≥n */
  border-radius: 12px;     /* esquinas redondeadas */
  border: 3px solid #d4af37; /* borde dorado */
  box-shadow: 0 4px 10px rgba(0,0,0,0.4);
}

  </style>
</head>

<body>

  <nav>
    <h2>üíà Barber Studio Zuriel Miranda</h2>

    <div class="info-horario">
      Lunes a s√°bado 10 AM - 8 PM ‚Ä¢ Domingo 10 AM - 4 PM ‚Ä¢ üìû 7751225190
    </div>

    <ul>
      <li><a href="#inicio">Inicio</a></li>
      <li><a href="#servicios">Servicios</a></li>
      <li><a href="#formulario">Cita</a></li>
    </ul>

    <div>
      <span id="usuario" style="margin-right:10px; color:#f1c93b; font-weight:bold;"></span>
      <button id="modo">üåô</button>
      <button id="logout">Cerrar Sesi√≥n</button>
    </div>
  </nav>

  <header id="inicio" class="hero" data-aos="fade-in">
    <div class="overlay"></div>
    <div class="hero-content">
      <h1>üíà Barber Studio Zuriel Miranda</h1>
      <p>Transforma tu look, define tu estilo ‚úÇÔ∏è</p>
      <a href="#formulario" class="btn-cta">Agendar Cita</a>
    </div>
  </header>
<section id="servicios" class="servicios" data-aos="fade-up">
    <h2>Lo que ofrecemos</h2>

    <div class="grid-servicios">
      <div class="servicio" data-aos="zoom-in">
        <h3>Cortes de Cabello</h3>
        <p>Cl√°sico, base, desvanecido, navaja, fade, delineado de barba y barba spa.</p>
      </div>

      <div class="servicio" data-aos="zoom-in">
        <h3>Facial</h3>
        <p>Exfoliante, hidratante, puntos negros y ozono.</p>
      </div>

      <div class="servicio" data-aos="zoom-in">
        <h3>Depilaci√≥n</h3>
        <p>Ceja, nasal, rostro, bigote y barba.</p>
      </div>

      <div class="servicio" data-aos="zoom-in">
        <h3>Servicios Extras</h3>
        <p>Pedicure, efectos de color, permanente y manicure.</p>
      </div>
    </div>

    <!-- üî• Cuadro de im√°genes cuadradas -->
    <div class="servicios-imagenes">
      <img src="images/corte.jpg" alt="Corte moderno">
      <img src="images/facial.jpg" alt="Facial">
      <img src="images/tinte.jpg" alt="Tinte">
    </div>
</section>


  <section id="formulario" class="formulario" data-aos="fade-up">
    <h2>Reserva tu turno</h2>

    <form id="formCita">
      <label for="nombre">Nombre completo:</label>
      <input type="text" id="nombre" placeholder="Ejemplo: Carlos P√©rez" required />

      <label for="fecha">Fecha:</label>
      <input type="date" id="fecha" required />

      <label for="hora">Hora:</label>
      <input type="time" id="hora" required />

      <label for="servicio">Servicio:</label>
      <select id="servicio">
        <option value="">Selecciona un servicio</option>

    <optgroup label="Corte de Cabello">
            <option value="Cl√°sico" data-precio="120">Cl√°sico - $120</option>
            <option value="Base" data-precio="120">Base - $120</option>
            <option value="Desvanecido" data-precio="170">Desvanecido - $170</option>
            <option value="Navaja" data-precio="180">Navaja - $180</option>
            <option value="Fade" data-precio="200">Fade - $200</option>
            <option value="Delineado de barba" data-precio="70">Delineado de barba - $70</option>
            <option value="Barba spa" data-precio="140">Barba spa - $140</option>
          </optgroup>

          <optgroup label="Facial">
            <option value="Exfoliante" data-precio="100">Exfoliante - $100</option>
            <option value="Hidratante" data-precio="120">Hidratante - $120</option>
            <option value="Puntos negros" data-precio="130">Puntos negros - $130</option>
            <option value="Ozono" data-precio="140">Ozono - $140</option>
            <option value="Mascarilla facial" data-precio="100">Mascarilla facial - $100</option>
          </optgroup>

          <optgroup label="Depilaci√≥n">
            <option value="Ceja" data-precio="60">Ceja - $60</option>
            <option value="Nasal" data-precio="50">Nasal - $50</option>
            <option value="Rostro" data-precio="70">Rostro - $70</option>
            <option value="Bigote" data-precio="55">Bigote - $55</option>
            <option value="Barba depilaci√≥n" data-precio="80">Barba - $80</option>
          </optgroup>

          <optgroup label="Servicios Extras">
            <option value="Pedicure" data-precio="200">Pedicure - $200</option>
            <option value="Efectos de color" data-precio="300">Efectos de color - $300</option>
            <option value="Permanente" data-precio="250">Permanente - $250</option>
            <option value="Manicure" data-precio="180">Manicure - $180</option>
            <option value="Lavado de cabello" data-precio="50">Lavado de cabello - $50</option>
            <option value="Tinte" data-precio="250">Tinte - $250</option>
          </optgroup>
      </select>

      <button type="button" id="btnAgregar" class="btn-enviar" style="margin-top:10px;">
        Agregar servicio
      </button>

      <h3 style="margin-top:20px; color:#ffd700;">Servicios seleccionados:</h3>
      <ul id="listaServicios"></ul>

      <div id="total" style="margin-top: 15px; font-size: 18px; font-weight: bold; color: #ffd700;">
        Total: $0
      </div>

      <button type="submit" class="btn-enviar">Agendar cita</button>
    </form>
  </section>

  <div id="recordatorio">üîî ¬°Tienes una cita agendada! Revisa los detalles abajo.</div>

  <section class="citas" data-aos="fade-up">
    <h2>Citas Agendadas</h2>
    <ul id="listaCitas"></ul>
  </section>

  <footer>
    <p>üìç Calle del 57 Avenida 21 de Marzo</p>
    <p>üìû WhatsApp:  7751225190</p>
    <p>&copy; 2025 Barber Studio Zuriel Miranda - Todos los derechos reservados</p>
  </footer>

  <a href="https://wa.me/527751225190" target="_blank" class="btn-whatsapp">üí¨</a>

  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

  <script>
    AOS.init();

    // ---------- VARIABLES PRINCIPALES ----------
    let servicios = [];           // array con servicios agregados
    let total = 0;               // total acumulado
    const precios = {
      "Cl√°sico": 120,
      "Base": 120,
      "Desvanecido": 170,
      "Navaja": 180,
      "Fade": 200,
      "Delineado de barba": 70,
      "Barba spa":140,
      "Exfoliante": 100,
      "Hidratante": 120,
      "Puntos negros": 130,
      "Ozono": 140,
      "Mascarilla facial":100,
      "Ceja": 60,
      "Nasal": 50,
      "Rostro": 70,
      "Bigote": 55,
      "Barba": 80,
      "Pedicure": 200,
      "Efectos de color": 300,
      "Permanente": 250,
      "Manicure": 180,
      "Lavado de cabello":50,
      "Tinte":250
    };

    // ---------- ELEMENTOS ----------
    const usuarioLabel = document.getElementById("usuario");
    const btnModo = document.getElementById("modo");
    const logoutBtn = document.getElementById("logout");

    const selectServicio = document.getElementById("servicio");
    const btnAgregar = document.getElementById("btnAgregar");
    const listaServicios = document.getElementById("listaServicios");
    const totalDiv = document.getElementById("total");

    const form = document.getElementById("formCita");
    const fechaInput = document.getElementById("fecha");
    const horaInput = document.getElementById("hora");
    const listaCitas = document.getElementById("listaCitas");
    const recordatorio = document.getElementById("recordatorio");

    // ---------- UI: usuario y modo ----------
    const usuario = localStorage.getItem("usuario");
    if (!usuario) {
      // si no hay usuario, redirigir a login
      // comentado para desarrollo: window.location.href = "login.html";
    } else {
      usuarioLabel.textContent = usuario;
    }

    logoutBtn.addEventListener("click", () => {
      localStorage.removeItem("usuario");
      window.location.href = "login.html";
    });

    btnModo.addEventListener("click", () => {
      document.body.classList.toggle("light");
      btnModo.textContent = document.body.classList.contains("light") ? "üåû" : "üåô";
    });

    // ---------- fecha m√≠nima (no d√≠as pasados) ----------
    function setFechaMinima() {
      const hoy = new Date().toISOString().split("T")[0];
      fechaInput.min = hoy;
    }
    setFechaMinima();

    // ---------- validar horario segun d√≠a ----------
    function validarHorario() {
      if (!fechaInput.value) return;
      const fecha = new Date(fechaInput.value);
      const dia = fecha.getDay();

      let minH, maxH;
      if (dia === 0) {
        minH = "10:00";
        maxH = "16:00";
      } else {
        minH = "10:00";
        maxH = "20:00";
      }

      horaInput.min = minH;
      horaInput.max = maxH;

      if (horaInput.value && (horaInput.value < minH || horaInput.value > maxH)) {
        horaInput.value = "";
      }
    }
    fechaInput.addEventListener("change", validarHorario);

    // ---------- agregar servicio a la lista ----------
    function actualizarListaServiciosUI() {
      listaServicios.innerHTML = "";
      servicios.forEach((s, idx) => {
        const li = document.createElement("li");
        li.textContent = `${s} - $${precios[s] || 0}`;

        // bot√≥n eliminar servicio
        const btn = document.createElement("button");
        btn.textContent = "Eliminar";
        btn.style.marginLeft = "10px";
        btn.style.background = "#d9534f";
        btn.style.color = "#fff";
        btn.style.border = "none";
        btn.style.padding = "4px 8px";
        btn.style.borderRadius = "4px";
        btn.style.cursor = "pointer";

        btn.addEventListener("click", () => {
          // quitar del array y actualizar total
          total -= (precios[s] || 0);
          servicios.splice(idx, 1);
          actualizarListaServiciosUI();
          actualizarTotalUI();
        });

        li.appendChild(btn);
        listaServicios.appendChild(li);
      });
    }

    function actualizarTotalUI() {
      totalDiv.textContent = `Total: $${total}`;
    }

    btnAgregar.addEventListener("click", () => {
      const servicio = selectServicio.value;
      if (!servicio) {
        alert("Selecciona un servicio antes de agregarlo.");
        return;
      }

      servicios.push(servicio);
      total += (precios[servicio] || 0);
      actualizarListaServiciosUI();
      actualizarTotalUI();

      // limpiar select para agregar otro
      selectServicio.value = "";
    });

    // ---------- submit: enviar cita al backend ----------
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const nombre = document.getElementById("nombre").value.trim();
      const fecha = fechaInput.value;
      const hora = horaInput.value;

      // validaciones b√°sicas
      if (!nombre) { alert("Ingresa el nombre"); return; }
      if (!fecha) { alert("Selecciona una fecha"); return; }
      if (!hora) { alert("Selecciona una hora"); return; }
      if (servicios.length === 0) { alert("Debes agregar por lo menos 1 servicio"); return; }

      // validar horario actual
      if (horaInput.min && (hora < horaInput.min || hora > horaInput.max)) {
        alert("‚õî La hora no es v√°lida para el horario del d√≠a seleccionado.");
        return;
      }

      // construir objeto cita: enviamos ambas formas para compatibilidad backend
      const cita = {
        nombreCliente: nombre,
        fecha,
        hora,
        servicios: servicios,                     // array
        servicio: servicios.join(", "),           // string para modelos antiguos
        total: total
      };

      try {
        const res = await fetch("https://barberia-backend-f312.onrender.com/citas", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(cita)
        });

        const data = await res.json();

        if (data.ok) {
          // limpieza UI
          form.reset();
          servicios = [];
          total = 0;
          actualizarListaServiciosUI();
          actualizarTotalUI();
          recordatorio.style.display = "block";
          // recargar citas (lista local)
          cargarCitas();
        } else {
          alert("‚ùå Error al guardar la cita: " + (data.mensaje || ""));
        }
      } catch (err) {
        console.error(err);
        alert("‚ùå Error de conexi√≥n al servidor. Revisa la consola del navegador.");
      }
    });

    // ---------- cargar citas desde backend ----------
    async function cargarCitas() {
      try {
        const res = await fetch("https://barberia-backend-f312.onrender.com/citas");
        const data = await res.json();

        listaCitas.innerHTML = "";

        if (!data.ok) {
          console.warn("Backend respondi√≥ sin ok para /citas:", data);
          return;
        }

        data.citas.forEach(c => {
          const li = document.createElement("li");
          // c.servicio o c.servicios (depende de c√≥mo guard√≥ tu backend)
          const serviciosText = c.servicio || c.servicios || ""; 
          const totalText = c.total !== undefined ? ` | Total: $${c.total}` : "";
          li.textContent = `${c.nombreCliente} - ${c.fecha} | ${c.hora} | ${serviciosText}${totalText}`;
          listaCitas.appendChild(li);
        });
      } catch (err) {
        console.error("Error cargando citas:", err);
      }
    }

    // Inicializa UI al cargar
    actualizarTotalUI();
    cargarCitas();

  </script>
</body>
</html>
